% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\title{week14 Core-IP}
\author{Jabin Oganga}
\date{19/11/2021}

\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={week14 Core-IP},
  pdfauthor={Jabin Oganga},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi

\begin{document}
\maketitle

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{knitr}\SpecialCharTok{::}\NormalTok{opts\_chunk}\SpecialCharTok{$}\FunctionTok{set}\NormalTok{(}\AttributeTok{echo =} \ConstantTok{TRUE}\NormalTok{,}\AttributeTok{eval =} \ConstantTok{FALSE}\NormalTok{,}\AttributeTok{cache =} \ConstantTok{FALSE}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(cars)}
\end{Highlighting}
\end{Shaded}

\hypertarget{loading-data-libraries}{%
\subsection{\texorpdfstring{\textbf{\emph{Loading Data \&
Libraries}}}{Loading Data \& Libraries}}\label{loading-data-libraries}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\#install.packages("tidyverse")}
\FunctionTok{library}\NormalTok{(tidyverse)}

\CommentTok{\#install.packages("ggplot2")}
\FunctionTok{library}\NormalTok{(ggplot2)}

\CommentTok{\#install.packages("caret")}
\FunctionTok{library}\NormalTok{(caret)}

\CommentTok{\#install.packages("caretEnsemble")}
\FunctionTok{library}\NormalTok{(caretEnsemble)}

\CommentTok{\#install.packages("factoextra")}
\FunctionTok{library}\NormalTok{(factoextra)}

\CommentTok{\#install.packages("class")}
\FunctionTok{library}\NormalTok{(class)}

\CommentTok{\#install.packages("FactoMineR")}
\FunctionTok{library}\NormalTok{(FactoMineR)}

\CommentTok{\#install.packages(\textquotesingle{}psych\textquotesingle{})}
\FunctionTok{library}\NormalTok{(psych)}

\CommentTok{\#install.packages(\textquotesingle{}Amelia\textquotesingle{})}
\FunctionTok{library}\NormalTok{(Amelia)}

\CommentTok{\#install.packages(\textquotesingle{}mice\textquotesingle{})}
\FunctionTok{library}\NormalTok{(mice)}

\CommentTok{\#install.packages(\textquotesingle{}GGally\textquotesingle{})}
\FunctionTok{library}\NormalTok{(GGally)}

\CommentTok{\#install.packages(\textquotesingle{}rpart\textquotesingle{})}
\FunctionTok{library}\NormalTok{(rpart)}

\CommentTok{\#install.packages(\textquotesingle{}randomForest\textquotesingle{})}
\FunctionTok{library}\NormalTok{(randomForest)}

\CommentTok{\#install.packages("dplyr")}
\FunctionTok{library}\NormalTok{(dplyr)}
\end{Highlighting}
\end{Shaded}

\hypertarget{loading-the-datasets}{%
\subsection{\texorpdfstring{\textbf{\emph{Loading the
datasets}}}{Loading the datasets}}\label{loading-the-datasets}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{carr1 }\OtherTok{=} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"http://bit.ly/CarreFourDataset"}\NormalTok{)}
\NormalTok{carr2 }\OtherTok{=} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"http://bit.ly/SupermarketDatasetII"}\NormalTok{)}
\NormalTok{carr3 }\OtherTok{=} \FunctionTok{read.csv}\NormalTok{(}\StringTok{"http://bit.ly/CarreFourSalesDataset"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(carr1)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(carr2)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(carr3)}
\end{Highlighting}
\end{Shaded}

\hypertarget{part-i-dimentionality-reduction}{%
\subsection{\texorpdfstring{\textbf{\emph{Part I: Dimentionality
Reduction}}}{Part I: Dimentionality Reduction}}\label{part-i-dimentionality-reduction}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{carr1}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{rows }\OtherTok{\textless{}{-}} \FunctionTok{nrow}\NormalTok{(carr1)}
\NormalTok{cols }\OtherTok{\textless{}{-}} \FunctionTok{ncol}\NormalTok{(carr1)}
\NormalTok{cha1 }\OtherTok{\textless{}{-}} \StringTok{"The No. of Rows is"}
\NormalTok{cha2 }\OtherTok{\textless{}{-}}  \StringTok{"\& The No. of Columns is"} 

\FunctionTok{cat}\NormalTok{(cha1, rows, cha2, cols)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str}\NormalTok{(carr1)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{=} \DecValTok{1}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in}\NormalTok{ carr1[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{16}\NormalTok{])\{}
\NormalTok{  names }\OtherTok{\textless{}{-}} \FunctionTok{names}\NormalTok{(carr1)[x]}
  \FunctionTok{print}\NormalTok{(names)}
  
\NormalTok{  values }\OtherTok{\textless{}{-}} \FunctionTok{length}\NormalTok{(}\FunctionTok{unique}\NormalTok{(i))}
  \FunctionTok{print}\NormalTok{(values)}
  
  
\NormalTok{x }\OtherTok{=}\NormalTok{ x }\SpecialCharTok{+} \DecValTok{1}  
\NormalTok{\}}
\CommentTok{\# x = x + 1}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{lapply}\NormalTok{ (carr1, class)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{null }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(carr1))}
\NormalTok{null}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{colSums}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(carr1))}
\NormalTok{colSums}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{sum}\NormalTok{(}\FunctionTok{duplicated}\NormalTok{(carr1))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{x }\OtherTok{=} \DecValTok{1}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in}\NormalTok{ carr1[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{16}\NormalTok{])\{}
  \ControlFlowTok{if}\NormalTok{ (}\FunctionTok{class}\NormalTok{(i) }\SpecialCharTok{==} \StringTok{"numeric"}\NormalTok{)\{}
    \CommentTok{\#x \textless{}{-} plots[, i]}
    \FunctionTok{boxplot}\NormalTok{(i,}\AttributeTok{main =} \FunctionTok{paste}\NormalTok{(}\FunctionTok{names}\NormalTok{(carr1)[x]), }\AttributeTok{col=} \StringTok{"orange"}\NormalTok{)\}}
    \CommentTok{\# names \textless{}{-} names(Kira)[i]}
  
  
  
  \ControlFlowTok{if}\NormalTok{ (}\FunctionTok{class}\NormalTok{(i) }\SpecialCharTok{==} \StringTok{"integer"}\NormalTok{)\{}
    \CommentTok{\#x \textless{}{-} plots[, i]}
    \FunctionTok{boxplot}\NormalTok{(i, }\AttributeTok{main =} \FunctionTok{paste}\NormalTok{(}\FunctionTok{names}\NormalTok{(carr1)[x]), }\AttributeTok{col=} \StringTok{"cyan"}\NormalTok{)\}}
  
  
  \ControlFlowTok{else}\NormalTok{ \{}
    \FunctionTok{print}\NormalTok{(}\StringTok{"No plot"}\NormalTok{)}
\NormalTok{  \}}
  
\NormalTok{  x }\OtherTok{=}\NormalTok{ x }\SpecialCharTok{+} \DecValTok{1}
  
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{carr1 }\OtherTok{\textless{}{-}} \FunctionTok{na.omit}\NormalTok{(carr1)}
\FunctionTok{sum}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(carr1))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{carr1 }\OtherTok{\textless{}{-}}\NormalTok{ carr1[}\SpecialCharTok{!}\FunctionTok{duplicated}\NormalTok{(kira),]}
\FunctionTok{sum}\NormalTok{(}\FunctionTok{duplicated}\NormalTok{(carr1))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{unique}\NormalTok{(carr1}\SpecialCharTok{$}\NormalTok{Branch)}
\NormalTok{carr1}\SpecialCharTok{$}\NormalTok{Branch }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(carr1}\SpecialCharTok{$}\NormalTok{Branch,}
\NormalTok{levels }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"A"}\NormalTok{, }\StringTok{"B"}\NormalTok{, }\StringTok{"C"}\NormalTok{),}
\NormalTok{labels }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{))}
\FunctionTok{unique}\NormalTok{(carr1}\SpecialCharTok{$}\NormalTok{Branch)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{unique}\NormalTok{(carr1}\SpecialCharTok{$}\NormalTok{Payment)}
\NormalTok{carr1}\SpecialCharTok{$}\NormalTok{Payment }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(carr1}\SpecialCharTok{$}\NormalTok{Payment,}
\NormalTok{levels }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Ewallet"}\NormalTok{ , }\StringTok{"Cash"}\NormalTok{, }\StringTok{"Credit card"}\NormalTok{),}
\NormalTok{labels }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{))}
\FunctionTok{unique}\NormalTok{(carr1}\SpecialCharTok{$}\NormalTok{Payment)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{unique}\NormalTok{(carr1}\SpecialCharTok{$}\NormalTok{Customer.type)}
\NormalTok{carr1}\SpecialCharTok{$}\NormalTok{Customer.type }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(carr1}\SpecialCharTok{$}\NormalTok{Customer.type,}
\NormalTok{levels }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Member"}\NormalTok{ , }\StringTok{"Normal"}\NormalTok{),}
\NormalTok{labels }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{))}
\FunctionTok{unique}\NormalTok{(carr1}\SpecialCharTok{$}\NormalTok{Customer.type)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{unique}\NormalTok{(carr1}\SpecialCharTok{$}\NormalTok{Product.line)}
\NormalTok{carr1}\SpecialCharTok{$}\NormalTok{Product.line }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(carr1}\SpecialCharTok{$}\NormalTok{Product.line,}
\NormalTok{levels }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Health and beauty"}\NormalTok{ , }\StringTok{"Electronic accessories"}\NormalTok{, }\StringTok{"Home and lifestyle"}\NormalTok{,}\StringTok{"Sports and travel"}\NormalTok{, }\StringTok{"Food and beverages"}\NormalTok{, }\StringTok{"Fashion accessories"}\NormalTok{ ),}
\NormalTok{labels }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{,}\DecValTok{5}\NormalTok{,}\DecValTok{6}\NormalTok{))}
\FunctionTok{unique}\NormalTok{(carr1}\SpecialCharTok{$}\NormalTok{Product.line)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{unique}\NormalTok{(carr1}\SpecialCharTok{$}\NormalTok{Gender)}
\NormalTok{carr1}\SpecialCharTok{$}\NormalTok{Gender }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(carr1}\SpecialCharTok{$}\NormalTok{Gender,}
\NormalTok{levels }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{"Female"}\NormalTok{, }\StringTok{"Male"}\NormalTok{ ),}
\NormalTok{labels }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{))}
\FunctionTok{unique}\NormalTok{(carr1}\SpecialCharTok{$}\NormalTok{Gender)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{carr1.new }\OtherTok{\textless{}{-}}\NormalTok{ carr1[, }\FunctionTok{c}\NormalTok{(}\DecValTok{2}\SpecialCharTok{:}\DecValTok{8}\NormalTok{,}\DecValTok{11}\NormalTok{,}\DecValTok{12}\NormalTok{,}\DecValTok{13}\NormalTok{,}\DecValTok{14}\NormalTok{,}\DecValTok{15}\NormalTok{,}\DecValTok{16}\NormalTok{)]}
\FunctionTok{summary}\NormalTok{(carr1.new)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{head}\NormalTok{(carr1.new)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{names}\NormalTok{(carr1.new)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str}\NormalTok{(carr1.new)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(Rtsne)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{carr1.la }\OtherTok{\textless{}{-}}\NormalTok{ carr1.new}\SpecialCharTok{$}\NormalTok{Rating}
\NormalTok{carr1.new}\SpecialCharTok{$}\NormalTok{Rating }\OtherTok{\textless{}{-}} \FunctionTok{as.factor}\NormalTok{(carr1.new}\SpecialCharTok{$}\NormalTok{Rating)}

\NormalTok{colors }\OtherTok{=} \FunctionTok{rainbow}\NormalTok{(}\FunctionTok{length}\NormalTok{(}\FunctionTok{unique}\NormalTok{(carr1.new}\SpecialCharTok{$}\NormalTok{Rating)))}
\FunctionTok{names}\NormalTok{(colors) }\OtherTok{=} \FunctionTok{unique}\NormalTok{(carr1.new}\SpecialCharTok{$}\NormalTok{Rating)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{carr1.new.tsne }\OtherTok{\textless{}{-}} \FunctionTok{Rtsne}\NormalTok{(carr1.new[,}\DecValTok{1}\SpecialCharTok{:}\DecValTok{11}\NormalTok{,}\DecValTok{13}\NormalTok{], }\AttributeTok{dims =} \DecValTok{2}\NormalTok{, }\AttributeTok{perplexity =} \DecValTok{30}\NormalTok{, }\AttributeTok{verbose =} \ConstantTok{TRUE}\NormalTok{, }\AttributeTok{max\_iter =} \DecValTok{500}\NormalTok{)}

\NormalTok{carr1.new.time }\OtherTok{\textless{}{-}} \FunctionTok{system.time}\NormalTok{(}\FunctionTok{Rtsne}\NormalTok{(carr1.new[,}\DecValTok{1}\SpecialCharTok{:}\DecValTok{11}\NormalTok{,}\DecValTok{13}\NormalTok{], }\AttributeTok{dims =} \DecValTok{2}\NormalTok{, }\AttributeTok{perplexity =} \DecValTok{30}\NormalTok{, }\AttributeTok{verbose =} \ConstantTok{TRUE}\NormalTok{, }\AttributeTok{max\_iter =} \DecValTok{500}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{plot}\NormalTok{(carr1.new.tsne}\SpecialCharTok{$}\NormalTok{Y, }\AttributeTok{t =} \StringTok{\textquotesingle{}n\textquotesingle{}}\NormalTok{, }\AttributeTok{main =} \StringTok{"carr1.new.tsne"}\NormalTok{)}
\FunctionTok{text}\NormalTok{(carr1.new.tsne}\SpecialCharTok{$}\NormalTok{Y,}\AttributeTok{labels =}\NormalTok{ carr1.new}\SpecialCharTok{$}\NormalTok{Rating,}\AttributeTok{col =}\NormalTok{ colors[carr1.new}\SpecialCharTok{$}\NormalTok{Rating])}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(caret)}
\FunctionTok{library}\NormalTok{(corrplot)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{carr1.new2 }\OtherTok{\textless{}{-}}\NormalTok{ carr1[, }\FunctionTok{c}\NormalTok{(}\DecValTok{2}\SpecialCharTok{:}\DecValTok{8}\NormalTok{,}\DecValTok{11}\NormalTok{,}\DecValTok{12}\NormalTok{,}\DecValTok{13}\NormalTok{,}\DecValTok{14}\NormalTok{,}\DecValTok{15}\NormalTok{,}\DecValTok{16}\NormalTok{)]}
\FunctionTok{str}\NormalTok{(carr1.new2)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{carr1.new2}\SpecialCharTok{$}\NormalTok{Branch }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(carr1.new2}\SpecialCharTok{$}\NormalTok{Branch)}
\NormalTok{carr1.new2}\SpecialCharTok{$}\NormalTok{Customer.type }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(carr1.new2}\SpecialCharTok{$}\NormalTok{Customer.type)}
\NormalTok{carr1.new2}\SpecialCharTok{$}\NormalTok{Gender }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(carr1.new2}\SpecialCharTok{$}\NormalTok{Gender)}
\NormalTok{carr1.new2}\SpecialCharTok{$}\NormalTok{Product.line }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(carr1.new2}\SpecialCharTok{$}\NormalTok{Product.line)}
\NormalTok{carr1.new2}\SpecialCharTok{$}\NormalTok{Payment }\OtherTok{\textless{}{-}} \FunctionTok{as.numeric}\NormalTok{(carr1.new2}\SpecialCharTok{$}\NormalTok{Payment)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str}\NormalTok{(carr1.new2)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{is.na}\NormalTok{(carr1.new2)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{names}\NormalTok{(carr1.new2)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{correlationMatrix }\OtherTok{\textless{}{-}} \FunctionTok{cor}\NormalTok{(carr1.new2)}

\NormalTok{highlyCorrelated }\OtherTok{\textless{}{-}} \FunctionTok{findCorrelation}\NormalTok{(correlationMatrix, }\AttributeTok{cutoff =} \FloatTok{0.75}\NormalTok{) }

\NormalTok{highlyCorrelated}
\FunctionTok{names}\NormalTok{(carr1.new2[,highlyCorrelated ])}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{carr\_feature }\OtherTok{\textless{}{-}}\NormalTok{ carr1.new2[}\SpecialCharTok{{-}}\NormalTok{highlyCorrelated]}

\FunctionTok{par}\NormalTok{(}\AttributeTok{mfrow =} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{2}\NormalTok{))}
\FunctionTok{corrplot}\NormalTok{(correlationMatrix, }\AttributeTok{order =} \StringTok{"hclust"}\NormalTok{)}
\FunctionTok{corrplot}\NormalTok{(}\FunctionTok{cor}\NormalTok{(carr\_feature),}\AttributeTok{order =} \StringTok{"hclust"}\NormalTok{ )}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(wskm)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(cluster)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{carr1.new2}\SpecialCharTok{$}\NormalTok{Rating }\OtherTok{\textless{}{-}} \FunctionTok{as.factor}\NormalTok{(carr1.new2}\SpecialCharTok{$}\NormalTok{Rating)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str}\NormalTok{(carr1.new2)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{2}\NormalTok{)}
\NormalTok{model\_carr }\OtherTok{\textless{}{-}} \FunctionTok{ewkm}\NormalTok{(carr1.new2[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{11}\NormalTok{,}\DecValTok{13}\NormalTok{],}\DecValTok{3}\NormalTok{, }\AttributeTok{lambda =} \DecValTok{2}\NormalTok{, }\AttributeTok{maxiter =} \DecValTok{500}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"Boruta"}\NormalTok{)}
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"mlbench"}\NormalTok{)}
\FunctionTok{install.packages}\NormalTok{(}\StringTok{"randomForest"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(Boruta)}
\FunctionTok{library}\NormalTok{(mlbench)}
\FunctionTok{library}\NormalTok{(randomForest)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{carr1.new3 }\OtherTok{\textless{}{-}}\NormalTok{ carr1[, }\FunctionTok{c}\NormalTok{(}\DecValTok{2}\SpecialCharTok{:}\DecValTok{8}\NormalTok{,}\DecValTok{11}\NormalTok{,}\DecValTok{12}\NormalTok{,}\DecValTok{13}\NormalTok{,}\DecValTok{14}\NormalTok{,}\DecValTok{15}\NormalTok{,}\DecValTok{16}\NormalTok{)]}
\FunctionTok{str}\NormalTok{(carr1.new2)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(clustvarsel)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(mclust)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{carr.out }\OtherTok{\textless{}{-}} \FunctionTok{clustvarsel}\NormalTok{(carr1.new3, }\AttributeTok{G =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{)}
\NormalTok{carr.out}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{subset.carr }\OtherTok{=}\NormalTok{ carr1.new3[, carr.out}\SpecialCharTok{$}\NormalTok{subset]}
\NormalTok{mod.carr }\OtherTok{=} \FunctionTok{Mclust}\NormalTok{(subset.carr, }\AttributeTok{G =} \DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{ )}
\FunctionTok{summary}\NormalTok{(mod.carr)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{111}\NormalTok{)}
\NormalTok{boruta }\OtherTok{\textless{}{-}} \FunctionTok{Boruta}\NormalTok{(Rating }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ., }\AttributeTok{data =}\NormalTok{ carr1.new3, }\AttributeTok{doTrace =} \DecValTok{2}\NormalTok{, }\AttributeTok{maxRuns =} \DecValTok{500}\NormalTok{)}

\FunctionTok{print}\NormalTok{(boruta)}
\FunctionTok{plot}\NormalTok{(boruta, }\AttributeTok{las =} \DecValTok{2}\NormalTok{, }\AttributeTok{cex.axis =} \FloatTok{0.7}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Tentative Fix}
\NormalTok{bor }\OtherTok{\textless{}{-}} \FunctionTok{TentativeRoughFix}\NormalTok{(boruta)}
\FunctionTok{print}\NormalTok{(bor)}
\FunctionTok{attStats}\NormalTok{(boruta)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{222}\NormalTok{)}
\NormalTok{ind }\OtherTok{\textless{}{-}} \FunctionTok{sample}\NormalTok{(}\DecValTok{2}\NormalTok{, }\FunctionTok{nrow}\NormalTok{(carr1.new3), }\AttributeTok{replace =}\NormalTok{ T, }\AttributeTok{prob =} \FunctionTok{c}\NormalTok{(}\FloatTok{0.6}\NormalTok{, }\FloatTok{0.4}\NormalTok{))}
\NormalTok{train }\OtherTok{\textless{}{-}}\NormalTok{ carr1.new3[ind }\SpecialCharTok{==} \DecValTok{1}\NormalTok{,]}
\NormalTok{test }\OtherTok{\textless{}{-}}\NormalTok{ carr1.new3[ind }\SpecialCharTok{==} \DecValTok{12}\NormalTok{,]}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{333}\NormalTok{)}
\NormalTok{forest.carr}\OtherTok{\textless{}{-}} \FunctionTok{randomForest}\NormalTok{(Rating }\SpecialCharTok{\textasciitilde{}}\NormalTok{ ., }\AttributeTok{data =}\NormalTok{ train)}

\NormalTok{forest.carr}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{conf }\OtherTok{\textless{}{-}} \FunctionTok{confusionMatrix}\NormalTok{(forest.carr)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{p }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(forest.carr, test)}
\FunctionTok{confusionMatrix}\NormalTok{(p, test}\SpecialCharTok{$}\NormalTok{Rating)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(arules)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{carr2}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{class}\NormalTok{(carr2)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{unique}\NormalTok{(carr2)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{rules }\OtherTok{\textless{}{-}} \FunctionTok{apriori}\NormalTok{(carr2)}
\NormalTok{rules}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(rules)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{rules }\OtherTok{\textless{}{-}} \FunctionTok{apriori}\NormalTok{(carr2,}\AttributeTok{parameter =} \FunctionTok{list}\NormalTok{(}\AttributeTok{supp =}\FloatTok{0.001}\NormalTok{, }\AttributeTok{conf =} \FloatTok{0.8}\NormalTok{))}
\FunctionTok{inspect}\NormalTok{(rules)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(carr2)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(rules)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{rules }\OtherTok{\textless{}{-}} \FunctionTok{sort}\NormalTok{(rules, }\AttributeTok{by =} \StringTok{"confidence"}\NormalTok{,}\AttributeTok{decreasing =} \ConstantTok{TRUE}\NormalTok{)}
\FunctionTok{inspect}\NormalTok{(rules[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{whole.weat.flour }\OtherTok{\textless{}{-}} \FunctionTok{subset}\NormalTok{(rules, }\AttributeTok{subset =}\NormalTok{ rhs }\SpecialCharTok{\%pin\%} \StringTok{"whole.weat.flour"}\NormalTok{)}

\NormalTok{whole.weat.flour }\OtherTok{\textless{}{-}} \FunctionTok{sort}\NormalTok{(whole.weat.flour, }\AttributeTok{by =} \StringTok{"confidence"}\NormalTok{, }\AttributeTok{decreasing =} \ConstantTok{TRUE}\NormalTok{)}
\FunctionTok{inspect}\NormalTok{(whole.weat.flour[}\DecValTok{1}\SpecialCharTok{:}\DecValTok{5}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(anomalize)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pkg }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\StringTok{\textquotesingle{}tidyverse\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}tibbletime\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}anomalize\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}timetk\textquotesingle{}}\NormalTok{)}
\FunctionTok{install.packages}\NormalTok{(pkg)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\FunctionTok{library}\NormalTok{(tibbletime)}
\FunctionTok{library}\NormalTok{(anomalize)}
\FunctionTok{library}\NormalTok{(timetk)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{carr3}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{str}\NormalTok{(carr3)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{carr3}\SpecialCharTok{$}\NormalTok{Date }\OtherTok{\textless{}{-}} \FunctionTok{paste}\NormalTok{(carr3}\SpecialCharTok{$}\NormalTok{Date,}\StringTok{"1"}\NormalTok{, }\AttributeTok{sep =} \StringTok{"/"}\NormalTok{)}

\NormalTok{carr3}\SpecialCharTok{$}\NormalTok{Date }\OtherTok{\textless{}{-}} \FunctionTok{as.Date}\NormalTok{(carr3}\SpecialCharTok{$}\NormalTok{Date,format, }\AttributeTok{tryFormats =} \StringTok{"\%Y{-}\%m{-}\%d"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dates }\OtherTok{\textless{}{-}}\NormalTok{ carr3}\SpecialCharTok{$}\NormalTok{Date}
\NormalTok{carr3}\SpecialCharTok{$}\NormalTok{Date }\OtherTok{\textless{}{-}} \FunctionTok{as.Date}\NormalTok{(dates, }\StringTok{"\%d/\%m/\%y"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{carr3 }\OtherTok{\textless{}{-}}\NormalTok{ carr3 }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{select}\NormalTok{(Date, Sales)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{carr3 }\OtherTok{\textless{}{-}} \FunctionTok{as\_tibble}\NormalTok{(carr3)}
\FunctionTok{class}\NormalTok{(carr3)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{carr3}\SpecialCharTok{$}\NormalTok{Date }\OtherTok{\textless{}{-}} \FunctionTok{as.POSIXct}\NormalTok{(carr3}\SpecialCharTok{$}\NormalTok{Date, }\AttributeTok{format =} \StringTok{"\%Y{-}\%m{-}\%d"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{class}\NormalTok{(carr3}\SpecialCharTok{$}\NormalTok{Date)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{carr3}\SpecialCharTok{$}\NormalTok{Date}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{carr3 }\OtherTok{\textless{}{-}} \FunctionTok{na.omit}\NormalTok{(carr3)}
\FunctionTok{sum}\NormalTok{(}\FunctionTok{is.na}\NormalTok{(carr3))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{carr3.anomalized }\OtherTok{\textless{}{-}}\NormalTok{ carr3}\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{time\_decompose}\NormalTok{(Sales,}\AttributeTok{merge =} \ConstantTok{TRUE}\NormalTok{)}\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{anomalize}\NormalTok{(remainder) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{time\_recompose}\NormalTok{()}\SpecialCharTok{\%\textgreater{}\%}
\NormalTok{carr3.anomalized }\SpecialCharTok{\%\textgreater{}\%} \FunctionTok{glimpse}\NormalTok{()}
\end{Highlighting}
\end{Shaded}


\end{document}
